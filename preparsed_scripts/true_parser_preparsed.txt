{"Block": [{"Let": {"Parameter": {"Name": "LBRACE", "Type": ":str"}, "Expression": {"String": "{"}, "Block": [{"Block": [{"Let": {"Parameter": {"Name": "RBRACE", "Type": ":str"}, "Expression": {"String": "}"}, "Block": [{"Block": [{"Let": {"Parameter": {"Name": "COLON", "Type": ":str"}, "Expression": {"String": ":"}, "Block": [{"Block": [{"Let": {"Parameter": {"Name": "COMMA", "Type": ":str"}, "Expression": {"String": ","}, "Block": [{"Block": [{"Let": {"Parameter": {"Name": "LBRACK", "Type": ":str"}, "Expression": {"String": "["}, "Block": [{"Block": [{"Let": {"Parameter": {"Name": "RBRACK", "Type": ":str"}, "Expression": {"String": "]"}, "Block": [{"Block": [{"Let": {"Parameter": {"Name": "quote", "Type": [":str",":str"]}, "Expression": {"Lambda": {"Parameters": [{"Name": "s", "Type": ":str"}], "Type": ":str", "Block": [{"Application": {"Operator": {"Identifier": "concat"}, "Operands": [{"Application": {"Operator": {"Identifier": "dquote"}, "Operands": []}}, {"Identifier": "s"}, {"Application": {"Operator": {"Identifier": "dquote"}, "Operands": []}}]}}]}}, "Block": [{"Block": [{"Block": [{"Def": {"Parameter": {"Name": "ltrim_rec", "Type": [":str",":int",":str"]}, "Expression": {"Lambda": {"Parameters": [{"Name": "s", "Type": ":str"}, {"Name": "index", "Type": ":int"}], "Type": ":str", "Block": [{"Cond": [{"Test": {"Application": {"Operator": {"Identifier": "=="}, "Operands": [{"Identifier": "index"}, {"Application": {"Operator": {"Identifier": "len"}, "Operands": [{"Identifier": "s"}]}}]}}, "Consequent": {"String": ""}}, {"Test": {"Boolean": "true"}, "Consequent": {"Block": [{"Let": {"Parameter": {"Name": "char", "Type": ":str"}, "Expression": {"Application": {"Operator": {"Identifier": "substring"}, "Operands": [{"Identifier": "s"}, {"Identifier": "index"}, {"Number": 1}]}}, "Block": [{"Block": [{"Cond": [{"Test": {"Application": {"Operator": {"Identifier": "=="}, "Operands": [{"Identifier": "char"}, {"String": " "}]}}, "Consequent": {"Application": {"Operator": {"Identifier": "ltrim_rec"}, "Operands": [{"Identifier": "s"}, {"Application": {"Operator": {"Identifier": "add"}, "Operands": [{"Identifier": "index"}, {"Number": 1}]}}]}}}, {"Test": {"Boolean": "true"}, "Consequent": {"Application": {"Operator": {"Identifier": "substring"}, "Operands": [{"Identifier": "s"}, {"Identifier": "index"}, {"Application": {"Operator": {"Identifier": "sub"}, "Operands": [{"Application": {"Operator": {"Identifier": "len"}, "Operands": [{"Identifier": "s"}]}}, {"Identifier": "index"}]}}]}}}]}]}]}}]}}]}]}}}}, {"Def": {"Parameter": {"Name": "ltrim", "Type": [":str",":str"]}, "Expression": {"Lambda": {"Parameters": [{"Name": "s", "Type": ":str"}], "Type": ":str", "Block": [{"Application": {"Operator": {"Identifier": "ltrim_rec"}, "Operands": [{"Identifier": "s"}, {"Number": 0}]}}]}}}}, {"Def": {"Parameter": {"Name": "findCommaRec", "Type": [":str",":int",":int",":int"]}, "Expression": {"Lambda": {"Parameters": [{"Name": "argsStr", "Type": ":str"}, {"Name": "index", "Type": ":int"}, {"Name": "parenDepth", "Type": ":int"}], "Type": ":int", "Block": [{"Cond": [{"Test": {"Application": {"Operator": {"Identifier": "=="}, "Operands": [{"Identifier": "index"}, {"Application": {"Operator": {"Identifier": "len"}, "Operands": [{"Identifier": "argsStr"}]}}]}}, "Consequent": {"Number": -1}}, {"Test": {"Boolean": "true"}, "Consequent": {"Block": [{"Let": {"Parameter": {"Name": "char", "Type": ":str"}, "Expression": {"Application": {"Operator": {"Identifier": "substring"}, "Operands": [{"Identifier": "argsStr"}, {"Identifier": "index"}, {"Number": 1}]}}, "Block": [{"Block": [{"Cond": [{"Test": {"Application": {"Operator": {"Identifier": "=="}, "Operands": [{"Identifier": "char"}, {"String": "("}]}}, "Consequent": {"Application": {"Operator": {"Identifier": "findCommaRec"}, "Operands": [{"Identifier": "argsStr"}, {"Application": {"Operator": {"Identifier": "add"}, "Operands": [{"Identifier": "index"}, {"Number": 1}]}}, {"Application": {"Operator": {"Identifier": "add"}, "Operands": [{"Identifier": "parenDepth"}, {"Number": 1}]}}]}}}, {"Test": {"Boolean": "true"}, "Consequent": {"Block": [{"Cond": [{"Test": {"Application": {"Operator": {"Identifier": "=="}, "Operands": [{"Identifier": "char"}, {"String": ")"}]}}, "Consequent": {"Application": {"Operator": {"Identifier": "findCommaRec"}, "Operands": [{"Identifier": "argsStr"}, {"Application": {"Operator": {"Identifier": "add"}, "Operands": [{"Identifier": "index"}, {"Number": 1}]}}, {"Application": {"Operator": {"Identifier": "sub"}, "Operands": [{"Identifier": "parenDepth"}, {"Number": 1}]}}]}}}, {"Test": {"Boolean": "true"}, "Consequent": {"Block": [{"Cond": [{"Test": {"Application": {"Operator": {"Identifier": "=="}, "Operands": [{"Identifier": "char"}, {"Identifier": "COMMA"}]}}, "Consequent": {"Block": [{"Cond": [{"Test": {"Application": {"Operator": {"Identifier": "=="}, "Operands": [{"Identifier": "parenDepth"}, {"Number": 0}]}}, "Consequent": {"Identifier": "index"}}, {"Test": {"Boolean": "true"}, "Consequent": {"Application": {"Operator": {"Identifier": "findCommaRec"}, "Operands": [{"Identifier": "argsStr"}, {"Application": {"Operator": {"Identifier": "add"}, "Operands": [{"Identifier": "index"}, {"Number": 1}]}}, {"Identifier": "parenDepth"}]}}}]}]}}, {"Test": {"Boolean": "true"}, "Consequent": {"Application": {"Operator": {"Identifier": "findCommaRec"}, "Operands": [{"Identifier": "argsStr"}, {"Application": {"Operator": {"Identifier": "add"}, "Operands": [{"Identifier": "index"}, {"Number": 1}]}}, {"Identifier": "parenDepth"}]}}}]}]}}]}]}}]}]}]}}]}}]}]}}}}, {"Def": {"Parameter": {"Name": "findTopLevelComma", "Type": [":str",":int"]}, "Expression": {"Lambda": {"Parameters": [{"Name": "argsStr", "Type": ":str"}], "Type": ":int", "Block": [{"Application": {"Operator": {"Identifier": "findCommaRec"}, "Operands": [{"Identifier": "argsStr"}, {"Number": 0}, {"Number": 0}]}}]}}}}, {"Def": {"Parameter": {"Name": "parseNumber", "Type": [":str",":str"]}, "Expression": {"Lambda": {"Parameters": [{"Name": "operandStr", "Type": ":str"}], "Type": ":str", "Block": [{"Application": {"Operator": {"Identifier": "concat"}, "Operands": [{"Identifier": "LBRACE"}, {"Application": {"Operator": {"Identifier": "quote"}, "Operands": [{"String": "Number"}]}}, {"Identifier": "COLON"}, {"Identifier": "operandStr"}, {"Identifier": "RBRACE"}]}}]}}}}, {"Def": {"Parameter": {"Name": "parseIdentifier", "Type": [":str",":str"]}, "Expression": {"Lambda": {"Parameters": [{"Name": "identStr", "Type": ":str"}], "Type": ":str", "Block": [{"Application": {"Operator": {"Identifier": "concat"}, "Operands": [{"Identifier": "LBRACE"}, {"Application": {"Operator": {"Identifier": "quote"}, "Operands": [{"String": "Identifier"}]}}, {"Identifier": "COLON"}, {"Application": {"Operator": {"Identifier": "quote"}, "Operands": [{"Identifier": "identStr"}]}}, {"Identifier": "RBRACE"}]}}]}}}}, {"Def": {"Parameter": {"Name": "parseExpression", "Type": [":str",":str"]}, "Expression": {"Lambda": {"Parameters": [{"Name": "exprStr", "Type": ":str"}], "Type": ":str", "Block": [{"Let": {"Parameter": {"Name": "trimmedStr", "Type": ":str"}, "Expression": {"Application": {"Operator": {"Identifier": "ltrim"}, "Operands": [{"Identifier": "exprStr"}]}}, "Block": [{"Block": [{"Let": {"Parameter": {"Name": "openParenIndex", "Type": ":int"}, "Expression": {"Application": {"Operator": {"Identifier": "indexOf"}, "Operands": [{"Identifier": "trimmedStr"}, {"String": "("}]}}, "Block": [{"Block": [{"Cond": [{"Test": {"Application": {"Operator": {"Identifier": "=="}, "Operands": [{"Identifier": "openParenIndex"}, {"Number": -1}]}}, "Consequent": {"Block": [{"Cond": [{"Test": {"Application": {"Operator": {"Identifier": "=="}, "Operands": [{"Identifier": "trimmedStr"}, {"String": "COMMA"}]}}, "Consequent": {"Application": {"Operator": {"Identifier": "parseIdentifier"}, "Operands": [{"Identifier": "trimmedStr"}]}}}, {"Test": {"Boolean": "true"}, "Consequent": {"Application": {"Operator": {"Identifier": "parseNumber"}, "Operands": [{"Identifier": "trimmedStr"}]}}}]}]}}, {"Test": {"Boolean": "true"}, "Consequent": {"Application": {"Operator": {"Identifier": "parseApplication"}, "Operands": [{"Identifier": "trimmedStr"}]}}}]}]}]}}]}]}}]}}}}, {"Def": {"Parameter": {"Name": "parseArgsImpl", "Type": [":str",":str"]}, "Expression": {"Lambda": {"Parameters": [{"Name": "argsStr", "Type": ":str"}], "Type": ":str", "Block": [{"Let": {"Parameter": {"Name": "commaIndex", "Type": ":int"}, "Expression": {"Application": {"Operator": {"Identifier": "findTopLevelComma"}, "Operands": [{"Identifier": "argsStr"}]}}, "Block": [{"Block": [{"Cond": [{"Test": {"Application": {"Operator": {"Identifier": "=="}, "Operands": [{"Identifier": "commaIndex"}, {"Number": -1}]}}, "Consequent": {"Application": {"Operator": {"Identifier": "parseExpression"}, "Operands": [{"Identifier": "argsStr"}]}}}, {"Test": {"Boolean": "true"}, "Consequent": {"Block": [{"Let": {"Parameter": {"Name": "firstArg", "Type": ":str"}, "Expression": {"Application": {"Operator": {"Identifier": "substring"}, "Operands": [{"Identifier": "argsStr"}, {"Number": 0}, {"Identifier": "commaIndex"}]}}, "Block": [{"Block": [{"Let": {"Parameter": {"Name": "restOfArgs", "Type": ":str"}, "Expression": {"Application": {"Operator": {"Identifier": "substring"}, "Operands": [{"Identifier": "argsStr"}, {"Application": {"Operator": {"Identifier": "add"}, "Operands": [{"Identifier": "commaIndex"}, {"Number": 1}]}}, {"Application": {"Operator": {"Identifier": "sub"}, "Operands": [{"Application": {"Operator": {"Identifier": "len"}, "Operands": [{"Identifier": "argsStr"}]}}, {"Application": {"Operator": {"Identifier": "add"}, "Operands": [{"Identifier": "commaIndex"}, {"Number": 1}]}}]}}]}}, "Block": [{"Block": [{"Application": {"Operator": {"Identifier": "concat"}, "Operands": [{"Application": {"Operator": {"Identifier": "parseExpression"}, "Operands": [{"Identifier": "firstArg"}]}}, {"Identifier": "COMMA"}, {"Application": {"Operator": {"Identifier": "parseArgsImpl"}, "Operands": [{"Identifier": "restOfArgs"}]}}]}}]}]}}]}]}}]}}]}]}]}}]}}}}, {"Def": {"Parameter": {"Name": "parseArgs", "Type": [":str",":str"]}, "Expression": {"Lambda": {"Parameters": [{"Name": "argsStr", "Type": ":str"}], "Type": ":str", "Block": [{"Cond": [{"Test": {"Application": {"Operator": {"Identifier": "=="}, "Operands": [{"Application": {"Operator": {"Identifier": "len"}, "Operands": [{"Identifier": "argsStr"}]}}, {"Number": 0}]}}, "Consequent": {"String": ""}}, {"Test": {"Boolean": "true"}, "Consequent": {"Application": {"Operator": {"Identifier": "parseArgsImpl"}, "Operands": [{"Identifier": "argsStr"}]}}}]}]}}}}, {"Def": {"Parameter": {"Name": "parseApplication", "Type": [":str",":str"]}, "Expression": {"Lambda": {"Parameters": [{"Name": "inputStr", "Type": ":str"}], "Type": ":str", "Block": [{"Let": {"Parameter": {"Name": "openParenIndex", "Type": ":int"}, "Expression": {"Application": {"Operator": {"Identifier": "indexOf"}, "Operands": [{"Identifier": "inputStr"}, {"String": "("}]}}, "Block": [{"Block": [{"Let": {"Parameter": {"Name": "closeParenIndex", "Type": ":int"}, "Expression": {"Application": {"Operator": {"Identifier": "sub"}, "Operands": [{"Application": {"Operator": {"Identifier": "len"}, "Operands": [{"Identifier": "inputStr"}]}}, {"Number": 1}]}}, "Block": [{"Block": [{"Let": {"Parameter": {"Name": "operator", "Type": ":str"}, "Expression": {"Application": {"Operator": {"Identifier": "substring"}, "Operands": [{"Identifier": "inputStr"}, {"Number": 0}, {"Identifier": "openParenIndex"}]}}, "Block": [{"Block": [{"Let": {"Parameter": {"Name": "argsStr", "Type": ":str"}, "Expression": {"Application": {"Operator": {"Identifier": "substring"}, "Operands": [{"Identifier": "inputStr"}, {"Application": {"Operator": {"Identifier": "add"}, "Operands": [{"Identifier": "openParenIndex"}, {"Number": 1}]}}, {"Application": {"Operator": {"Identifier": "sub"}, "Operands": [{"Application": {"Operator": {"Identifier": "sub"}, "Operands": [{"Identifier": "closeParenIndex"}, {"Identifier": "openParenIndex"}]}}, {"Number": 1}]}}]}}, "Block": [{"Block": [{"Application": {"Operator": {"Identifier": "concat"}, "Operands": [{"Identifier": "LBRACE"}, {"Application": {"Operator": {"Identifier": "quote"}, "Operands": [{"String": "Application"}]}}, {"Identifier": "COLON"}, {"Identifier": "LBRACE"}, {"Application": {"Operator": {"Identifier": "quote"}, "Operands": [{"String": "Operator"}]}}, {"Identifier": "COLON"}, {"Identifier": "LBRACE"}, {"Application": {"Operator": {"Identifier": "quote"}, "Operands": [{"String": "Identifier"}]}}, {"Identifier": "COLON"}, {"Application": {"Operator": {"Identifier": "quote"}, "Operands": [{"Identifier": "operator"}]}}, {"Identifier": "RBRACE"}, {"Identifier": "COMMA"}, {"Application": {"Operator": {"Identifier": "quote"}, "Operands": [{"String": "Operands"}]}}, {"Identifier": "COLON"}, {"Identifier": "LBRACK"}, {"Application": {"Operator": {"Identifier": "parseArgs"}, "Operands": [{"Identifier": "argsStr"}]}}, {"Identifier": "RBRACK"}, {"Identifier": "RBRACE"}, {"Identifier": "RBRACE"}]}}]}]}}]}]}}]}]}}]}]}}]}}}}, {"Application": {"Operator": {"Identifier": "parseApplication"}, "Operands": [{"String": "print(div(add(mul(5, -1), sqrt(sub(pow(5, 2), mul(4, mul(1, 4))))), mul(2, 1)), div(sub(mul(5, -1), sqrt(sub(pow(5, 2), mul(4, mul(1, 4))))), mul(2, 1)))"}]}}]}]}]}}]}]}}]}]}}]}]}}]}]}}]}]}}]}]}}]}